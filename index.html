<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PEGedit</title>
    
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/text.css" />
    <link rel="stylesheet" href="css/960.css" />
    
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" />
    <!-- ACE editor -->
     <script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js" type="text/javascript"></script>	
    <!-- PEG.js -->
    <script src="./js/peg-0.8.0.js" type="text/javascript"></script>
    <!--jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript">
        var parser;
        
        var changeSize = function(target, delta) {
            target.setOption('fontSize', target.getOption('fontSize') + delta);
        };

        $('document').ready( function() {

            

            editor = ace.edit("editor");
            editor.setTheme("ace/theme/monokai");
            editor.getSession().setMode("ace/mode/javascript");
            editor.setOption("useWorker", false);
            editor.setOption("tabSize", 2);
            editor.setValue(localStorage["grammar"]);
            editor.getSession().on("change", function() {
                localStorage.setItem("grammar", editor.getValue());
            });
            $('#editor').css("height", window.innerHeight);
            editor.resize();
            output = ace.edit("output");
            output.setOption("useWorker", false);
            output.setValue(localStorage["source"]);
            output.getSession().on('change', function() {
                localStorage.setItem("source", output.getValue());
                $('#parse_btn').click();
            });
            $('#output').css("height", window.innerHeight);
            output.resize();

            $('#build_parser_btn').click( function() {
                try {
                    parser = PEG.buildParser(editor.getValue());

                } catch(e) {
                    console.error(e);
                }
                output.focus();
            });
            $('#parse_btn').click( function() {
                try {
                    result = parser.parse(output.getValue());
                    console.log(JSON.stringify(result)); 
                } catch(e) {
                    console.error(e);
                }

            });
            $('#zoom_in_btn').click( function() {
                changeSize(editor, 2);
                changeSize(output, 2);
        
            });
            $('#zoom_out_btn').click( function() {
                changeSize(editor, -2);
                changeSize(output, -2);
            })
            $(output).focus( function() {
                if (editor.getValue()) {
                    $('#build_parser_btn').click();
                }
            });
        });
    </script>
    <style type="text/css">
		body {
            background-color: gray;
        }
        .container-12 {
            background-color: #aaa;
        }
        #editor {
			height: 800px;
		}
        #output {
            height: 800px;
        }
	</style>  
</head>
  <body>
    <div class="container_12">
        <div id="toolbar" class="grid_8 alpha">
            
            <button id="build_parser_btn" type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-ok" aria-hidden="true">&nbsp;Build Parser</span>
            </button>

            <button id="zoom_in_btn" type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-zoom-in" aria-hidden="true">&nbsp;Zoom In</span>
            </button> 
            <button id="zoom_out_btn" type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-zoom-out" aria-hidden="true">&nbsp;Zoom Out</span>
            </button> 
        </div>
        <div class="grid_4 omega">
            <button id="parse_btn" type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-play" aria-hidden="true">&nbsp;Parse</span>
             </button> 
         </div>

        <div class="clear"></div>
            `
        <div id="editor" class="grid_8 alpha" ></div>
        
        <div id="output" class="grid_4 omega"></div>
        
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    
    <!-- Include all compiled plugins (below), or include individual files as needed -->    
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  </body>
</html>


/*

*/

